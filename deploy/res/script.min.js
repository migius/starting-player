function initPage() {
    putRandomRule(), num = Rules.length, document.getElementById("number").innerText = num
}

function putRandomRule() {
    var e = document.getElementById("rigaGioco");
    if (e.classList.add("rigaNascosta"), (e = document.getElementById("rigaGiocoAssente")).classList.add("rigaNascosta"), id = Math.floor(Math.random() * Rules.length), document.getElementById("randomPart").innerText = Rules[id].Rule, document.getElementById("Autore").innerText = Rules[id].Author, null !== Rules[id].Game) {
        var t = document.createElement("a");
        t.title = Rules[id].Game, t.href = Rules[id].Link, t.innerText = Rules[id].Game, t.classList = "btn btn-danger btn-lg", t.setAttribute("target", "_blank");
        var n = document.getElementById("Gioco");
        n.innerText = "", n.appendChild(t), (e = document.getElementById("rigaGioco")).classList.remove("rigaNascosta")
    } else(e = document.getElementById("rigaGiocoAssente")).classList.remove("rigaNascosta")
}
var Rules = [],
    num = 0,
    id = 0,
    xmlhttp = new XMLHttpRequest;
xmlhttp.onreadystatechange = function() {
    4 == this.readyState && 200 == this.status && (Rules = JSON.parse(this.responseText), initPage())
}, xmlhttp.open("GET", "../res/getRules.php?l=" + lang, !0), xmlhttp.send();
var modalSug = document.getElementById("myModal"),
    modalSeg = document.getElementById("myModal_Segnala"),
    btnSug = document.getElementById("openSug"),
    btnSeg = document.getElementById("openSegnala"),
    spanSug = document.getElementById("closeSug"),
    spanSeg = document.getElementById("closeSegnala");

function postSuggestion() {
    var e = new XMLHttpRequest;
    e.open("POST", "../res/sendSuggestion.php?l=" + document.getElementById("l").value + "&p=" + document.getElementById("s").value + "&a=" + document.getElementById("a").value + document.getElementById("Segnala_a").value + "&g=" + document.getElementById("g").value + document.getElementById("Segnala_g").value + "&id=" + id + "&rule=" + Rules[id].Rule), e.onload = function() {
        200 === e.status || alert("Request failed.  Returned status of " + e.status)
    }, e.send()
}
btnSug.onclick = function() {
    modalSug.style.display = "block"
}, btnSeg.onclick = function() {
    modalSeg.style.display = "block"
}, spanSug.onclick = function() {
    modalSug.style.display = "none"
}, spanSeg.onclick = function() {
    modalSeg.style.display = "none"
}, window.onclick = function(e) {
    e.target == modalSug && (modalSug.style.display = "none"), e.target == modalSeg && (modalSeg.style.display = "none")
};

//toast
setTimeout(function(){$('#alexa-toast').toast('show')}, 2000);
setTimeout(function(){$('#telegram-toast').toast('show')}, 4000);
